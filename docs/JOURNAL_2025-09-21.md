# Journal 2025-09-21

- Actions
  - Déport des sorties vers le disque externe via jonction `outputs -> E:\ichimoku_outputs\outputs`; nettoyage/filtrage des logs RUN pour éviter les fichiers géants.
  - Correction des relances: exécution depuis la racine du projet, variable `USE_FUSED_H2=1` pour lire `data/ BTC_FUSED_2h*.csv` (pas de téléchargement distant).
  - Extension du domaine de recherche: `shift ∈ [1,100]` (au lieu de [10,75]).
  - Ajout d’un suivi d’avancement non intrusif: chaque run écrit un `PROGRESS.json` (pourcentage, fold, trial) dans son dossier.
  - Désactivation des runs « monthly » (on garde WFA annuel, puis on calcule des métriques mensuelles en post‑analyse OOS).
  - Préparation et lancement des commandes par K (indépendantes), seeds séquentielles (une seed à la fois) avec contraintes MDD≤50% et 300 trials.

- Lancements du jour (par K, phase + fixed, annual, 300 trials, MDD≤50%)
  - K ∈ {2,3,5,8}, pour chacun: 30 seeds « phase » (labels gelés H2) puis 30 seeds « fixed » (annual sans phase).
  - Lecture DATA: `C:\…\data` (local). Écriture résultats: `E:\ichimoku_outputs\outputs` (via jonction).
  - Objectif: comparer K=2/3/5/8 et phase vs fixed sur 30 seeds/condition; agrégation robuste (médiane/IQR) des métriques OOS.

- Problèmes rencontrés et corrections
  - Espace disque et lenteurs OneDrive (RUN.txt > 1 GB): sorties déplacées sur E:, logs filtrés (uniquement « Saved/Overall/Trial »).
  - Erreur « Fused CSV not configured »: fixé en forçant `USE_FUSED_H2=1` et en lançant depuis la racine du workspace.
  - Ambiguïtés monthly vs objectif 10%/mois: clarifié; on reste en WFA annuel (pas de fuite d’info), la cible mensuelle est évaluée après coup.

- Avancement (snapshot, PROGRESS.json)
  - Exemple (06:36):
    - K2 phase: ~9.7% — Folds 1/14, Trials 107/300 (phase « optuna »)
    - K3 phase: ~8.4% — Folds 1/14, Trials 55/300 (optuna)
    - K5 phase: ~7.4% — Folds 1/14, Trials 10/300 (optuna)
    - K8 phase: ~7.1% — Folds 0/14, Trials 300/300 (optuna terminé, test imminent)
    - K2 fixed: pas encore démarré (enchaîné après les seeds phase).
  - Rappel: « fold » = année OOS du walk‑forward; « trials » = avancement Optuna sur l’année courante.

- Décisions et critères
  - Valider l’hypothèse « réglages Ichimoku adaptés par phase » si la cohérence inter‑seeds est élevée: IQR/med des rendements mensuels OOS ≲ 10% par phase et Calmar/Sharpe (sous MDD≤50%) > baseline.
  - Sélection finale par Calmar/Sharpe sous MDD≤50%, agrégation médiane/IQR (anti‑cherry‑pick), K={2,3,5,8}, phase vs fixed.

- Prochaines étapes
  - Laisser terminer K2/K3/K5/K8 (phase puis fixed) sur 30 seeds chacune.
  - Générer des résumés `WFA_SUMMARY_PHASE_K*.txt` et `WFA_SUMMARY_FIXED_K*.txt`, puis extraire les rendements mensuels OOS par phase.
  - Agréger (médiane/IQR) sur 30 seeds et comparer K et modes (phase vs fixed); retenir le meilleur sous MDD≤50%.
  - Mettre à jour `docs/TOP_BEST_RESULTS.md` et le rapport maître avec les comparatifs.


